# Критическая проблема: Отсутствие меандра в сигнале ГЛОНАСС

## Дата: 14 января 2025

## Проблема

Приёмники не видят сигналы ГЛОНАСС, потому что в реализации **полностью отсутствует меандр** - обязательный компонент модулирующей последовательности ГЛОНАСС.

## Что должно быть согласно ICD ГЛОНАСС

Согласно ICD ГЛОНАСС v5.1, модулирующая последовательность образуется сложением по модулю 2 **ТРЁХ** компонентов:

1. **ПС дальномерный код** - 511 кбит/с ✓ (реализован)
2. **Навигационное сообщение** - 50 бит/с ✓ (реализован)
3. **Меандр** - 100 бит/с ❌ (ОТСУТСТВУЕТ!)

### Характеристики меандра:
- Частота: 100 Гц (100 бит/с)
- Период: 10 мс
- Форма: прямоугольный сигнал (0101010101...)
- Синхронизация: границы символов меандра совпадают с границами символов навигационного сообщения

## Что реализовано сейчас

В текущей реализации:
- ✓ Временная метка передаётся правильно
- ✓ Навигационное сообщение формируется корректно
- ✓ ПС дальномерный код генерируется
- ❌ Меандр полностью отсутствует
- ❌ Нет сложения трёх компонентов по модулю 2

## Почему приёмники не видят сигнал

Без меандра сигнал ГЛОНАСС не соответствует стандарту. Приёмники ожидают увидеть результат сложения всех трёх компонентов. Отсутствие меандра делает сигнал нераспознаваемым.

## Необходимые исправления

### 1. Добавить генерацию меандра в SatelliteSignal.cpp:
```cpp
// Генерация меандра 100 Гц
int meander = ((TransmitTime.MilliSeconds / 10) % 2) ? 1 : 0;
```

### 2. Модифицировать финальную модуляцию в SatIfSignal.cpp:
```cpp
// Для ГЛОНАСС: PRN XOR Data XOR Meander
if (System == GlonassSystem) {
    int dataNavBit = /* текущий бит навигационных данных */;
    int meander = ((currentTimeMs / 10) % 2) ? 1 : 0;
    int prnChip = /* текущий чип PRN */;
    
    // Сложение по модулю 2 всех трёх компонентов
    int modulatedBit = prnChip ^ dataNavBit ^ meander;
    
    // BPSK модуляция
    signal = modulatedBit ? -1.0 : 1.0;
}
```

### 3. Убедиться в правильной синхронизации:
- Границы меандра должны совпадать с границами навигационных данных
- Период меандра 10 мс
- Частота переключения 100 Гц

## Схема правильной модуляции ГЛОНАСС

```
ПС код (511 кбит/с) ─┐
                     ├─ XOR ─→ BPSK модуляция → Несущая
Нав. данные (50 бит/с) ─┤
                     │
Меандр (100 Гц) ─────┘
```

## Заключение

Отсутствие меандра - это фундаментальная ошибка в реализации ГЛОНАСС. Без него сигнал не соответствует стандарту и не может быть обнаружен приёмниками. Необходимо срочно добавить генерацию меандра и правильное сложение всех трёх компонентов.