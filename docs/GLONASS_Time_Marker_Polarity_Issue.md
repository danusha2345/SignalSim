# Проблема с полярностью временной метки ГЛОНАСС

## Дата: 13 января 2025

## Обнаруженная проблема

При глубоком анализе реализации ГЛОНАСС обнаружена потенциальная проблема с полярностью модуляции временной метки.

### Текущая реализация

В файле `SatelliteSignal.cpp` временная метка модулируется следующим образом:

```cpp
DataBit = (TimeMarkerBitIndex < 30) ? (TimeMarkerBits[TimeMarkerBitIndex] ? -1 : 1) : 1;
```

Это означает:
- Бит 1 временной метки → амплитуда -1
- Бит 0 временной метки → амплитуда +1

Навигационные данные модулируются аналогично:
```cpp
DataBit = (DataBits[BitNumber] ? -1 : 1);
```

### Анализ проблемы

1. **Значение временной метки**: 0x1B8593A0 = 011011100001011001001110100000 (30 бит)

2. **Возможные варианты проблемы**:
   - Неправильная полярность модуляции временной метки
   - Неправильное значение временной метки
   - Временная метка должна передаваться в другом формате

3. **Согласно ICD ГЛОНАСС**:
   - Временная метка - это "укороченная ПСП" (псевдослучайная последовательность)
   - Используется для синхронизации приёмника
   - Должна быть уникальной и легко обнаруживаемой

### Возможные решения

#### Вариант 1: Инвертировать полярность временной метки
```cpp
// Инвертированная полярность только для временной метки
DataBit = (TimeMarkerBitIndex < 30) ? (TimeMarkerBits[TimeMarkerBitIndex] ? 1 : -1) : 1;
```

#### Вариант 2: Использовать другое значение временной метки
Необходимо проверить в официальной документации ICD ГЛОНАСС точное значение укороченной ПСП.

#### Вариант 3: Изменить формат передачи
Возможно, временная метка должна передаваться в другом формате (например, манчестерское кодирование).

### Рекомендации

1. **Срочно проверить в ICD ГЛОНАСС**:
   - Точное значение укороченной ПСП (временной метки)
   - Правила модуляции временной метки
   - Полярность сигнала

2. **Провести эксперимент**:
   - Попробовать инвертировать полярность временной метки
   - Записать сигнал и проанализировать с помощью SDR

3. **Сравнить с эталонным сигналом**:
   - Записать реальный сигнал ГЛОНАСС
   - Сравнить временную метку

### Заключение

Высока вероятность, что проблема невидимости сигналов ГЛОНАСС связана с:
1. Неправильной полярностью модуляции временной метки
2. Неправильным значением самой временной метки (0x1B8593A0)

Необходимо срочно проверить соответствие реализации официальному стандарту ICD ГЛОНАСС.