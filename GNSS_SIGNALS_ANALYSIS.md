# Анализ реализации GNSS сигналов в IFdataGen

## Общий обзор

Проект поддерживает следующие GNSS системы и сигналы:
- **GPS**: L1CA, L1C, L2C, L2P, L5
- **BeiDou**: B1C, B1I, B2I, B3I, B2a, B2b
- **Galileo**: E1, E5a, E5b, E6
- **GLONASS**: G1, G2

## Детальный анализ каждого сигнала

### 1. GPS

#### L1CA ✅
- **NavBit класс**: LNavBit (DataBitLNav)
- **Модуляция**: BPSK (без BOC)
- **Чип-рейт**: 1.023 Mcps
- **Частота**: 1575.42 МГц
- **Реализация**: Полная, стандартная

#### L1C ✅
- **NavBit класс**: CNav2Bit (DataBitCNav2)
- **Модуляция**: 
  - Data: BOC(1,1)
  - Pilot: TMBOC (QMBOC) - реализовано в SatIfSignal.cpp
- **Чип-рейт**: 1.023 Mcps × 2 = 2.046 Mcps
- **Частота**: 1575.42 МГц
- **Реализация**: Полная с корректной QMBOC модуляцией

#### L2C ✅
- **NavBit класс**: CNavBit (DataBitCNav)
- **Модуляция**: BPSK с time-multiplexed data
- **Чип-рейт**: 1.023 Mcps
- **Частота**: 1227.60 МГц
- **Реализация**: Полная, включает CM и CL коды

#### L2P ⚠️
- **NavBit класс**: LNavBit (DataBitLNav)
- **Модуляция**: BPSK
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1227.60 МГц
- **Проблема**: Создаётся пустой массив без генерации P(Y) кода
```cpp
case SIGNAL_INDEX_L2P:
    DataPrn  = new int[10230*2];  // Только выделение памяти!
    PilotPrn = NULL;
```

#### L5 ✅
- **NavBit класс**: CNavBit (DataBitCNav)
- **Модуляция**: QPSK (I и Q каналы)
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1176.45 МГц
- **Реализация**: Полная, корректная QPSK модуляция

### 2. BeiDou

#### B1C ✅
- **NavBit класс**: BCNav1Bit (DataBitBCNav1)
- **Модуляция**: Аналогично GPS L1C (BOC + QMBOC)
- **Чип-рейт**: 2.046 Mcps
- **Частота**: 1575.42 МГц
- **Реализация**: Полная

#### B1I ✅
- **NavBit класс**: D1D2NavBit (DataBitD1D2)
- **Модуляция**: BPSK
- **Чип-рейт**: 2.046 Mcps
- **Частота**: 1561.098 МГц
- **Реализация**: Полная, выбор D1/D2 по номеру спутника

#### B2I ✅
- **NavBit класс**: D1D2NavBit (DataBitD1D2)
- **Модуляция**: BPSK
- **Чип-рейт**: 2.046 Mcps
- **Частота**: 1207.14 МГц (на частоте B2b!)
- **Реализация**: Полная

#### B3I ✅
- **NavBit класс**: D1D2NavBit (DataBitD1D2)
- **Модуляция**: BPSK
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1268.52 МГц
- **Реализация**: Полная

#### B2a ✅
- **NavBit класс**: BCNav2Bit (DataBitBCNav2)
- **Модуляция**: QPSK (аналогично GPS L5)
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1176.45 МГц
- **Реализация**: Полная

#### B2b ✅
- **NavBit класс**: BCNav3Bit (DataBitBCNav3)
- **Модуляция**: BPSK (только data канал)
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1207.14 МГц
- **Реализация**: Полная

### 3. Galileo

#### E1 ✅
- **NavBit класс**: INavBit (DataBitINav)
- **Модуляция**: BOC(1,1) для обоих каналов
- **Чип-рейт**: 2.046 Mcps
- **Частота**: 1575.42 МГц
- **Реализация**: Полная, использует memory codes

#### E5a ✅
- **NavBit класс**: FNavBit (DataBitFNav)
- **Модуляция**: QPSK (I и Q каналы)
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1176.45 МГц
- **Реализация**: Полная

#### E5b ✅
- **NavBit класс**: INavBit (DataBitINav)
- **Модуляция**: QPSK (I и Q каналы)
- **Чип-рейт**: 10.23 Mcps
- **Частота**: 1207.14 МГц
- **Реализация**: Полная

#### E6 ⚠️
- **NavBit класс**: INavBit (DataBitINav) - временно
- **Модуляция**: Только pilot канал
- **Чип-рейт**: 5.115 Mcps
- **Частота**: 1278.75 МГц
- **Проблема**: Нет специализированного NavBit класса для E6 (используется INav)

### 4. GLONASS

#### G1 ✅
- **NavBit класс**: GNavBit (DataBitGNav)
- **Модуляция**: BPSK с FDMA
- **Чип-рейт**: 0.511 Mcps
- **Частота**: 1602 МГц + k×0.5625 МГц (FDMA)
- **Реализация**: Полная с корректной FDMA

#### G2 ✅
- **NavBit класс**: GNavBit (DataBitGNav)
- **Модуляция**: BPSK с FDMA
- **Чип-рейт**: 0.511 Mcps
- **Частота**: 1246 МГц + k×0.4375 МГц (FDMA)
- **Реализация**: Полная с корректной FDMA

## Выявленные проблемы

### 1. GPS L2P - Отсутствующая реализация P(Y) кода
**Проблема**: В PrnGenerate.cpp для L2P создаётся пустой массив без генерации кода.
**Влияние**: Сигнал L2P не будет генерироваться корректно.
**Рекомендация**: Либо реализовать упрощённую версию P-кода, либо явно отключить L2P.

### 2. Galileo E6 - Временный NavBit класс
**Проблема**: Используется INavBit вместо специализированного класса для E6.
**Влияние**: Навигационные данные могут быть некорректными.
**Рекомендация**: Реализовать ECNavBit класс для E6 C/NAV.

### 3. Отсутствующие NavBit классы
- DataBitGNav2 - создаётся как NULL
- DataBitECNav - создаётся как NULL
- DataBitSbas - создаётся как NULL

## Особенности реализации

### Модуляция BOC
- Корректно реализована для L1C/B1C (включая QMBOC для pilot)
- Корректно реализована для E1

### QPSK модуляция
- Корректно реализована для L5, B2a, E5a, E5b
- Использует комплексные числа для I/Q разделения

### FDMA для GLONASS
- Корректно рассчитываются частотные сдвиги
- Учитывается половинный цикл для нечётных частотных каналов

## Рекомендации

1. **Срочно**: Исправить реализацию GPS L2P или отключить его генерацию
2. **Важно**: Реализовать ECNavBit для Galileo E6
3. **Желательно**: Добавить поддержку GLONASS L3 (CDMA)
4. **Проверить**: Корректность навигационных данных для всех сигналов

## Итоговая оценка

- **Полностью рабочие**: L1CA, L1C, L2C, L5, B1C, B1I, B2I, B3I, B2a, B2b, E1, E5a, E5b, G1, G2
- **Частично рабочие**: E6 (нет специализированного NavBit)
- **Нерабочие**: L2P (нет генерации кода)

**Общая готовность: 14.5/17 сигналов (85%)**